<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PhotomaticsID</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">  
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <style>
        .table-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 8px;
        }
        #reviewTable th, 
        #reviewTable td {
            text-align: center;
            vertical-align: middle;
        }
        #reviewTable td.review-col,
        #reviewTable th.review-col {
            width: 40%;
        }
    </style>      
</head>

<body style="background-color:rgb(255, 255, 255); padding-top: 70px; padding-bottom: 70px;">
    <!-- Header -->
    <nav class="navbar navbar-expand-lg fixed-top" style="background-color: #f6c36d;">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <img src="Logo.webp" alt="Logo" width="30" height="24" class="d-inline-block align-text-top">
              </a>
            <a class="navbar-brand" href="Homepage.html">Photomatic's Homepage</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="Gallery.html">Gallery</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Location.html">Location</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            More
                        </a>
                        <ul class="dropdown-menu" style="background-color: #eecc92;">
                            <li><a class="dropdown-item" href="Review.html">Our Review</a></li>
                            <li><a class="dropdown-item" href="Contact.html">Contact Us</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="Request.html">Request Resent Soft Copy</a></li>
                        </ul>
                    </li>
                </ul>
                <ul class="nav">
                    <li class="nav-item">
                        <a class="nav-link disabled" aria-disabled="true">2025.nlp</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Form Review -->
    <div id="FormResent" class="container">
        <h1 class="text-center"><i>Share Ur Experience Here!</i></h1>
        <hr>
        <p class="text-center">We'd love to hear from you! Your feedback helps us grow and serve you better. Drop your thoughts below â€” whether it's love, suggestions, or anything in between!</p>

        <form id="reviewForm">
            <div class="mb-3">
                <label for="namaInput" class="form-label"><b>Username Instagram</b></label>
                <input type="text" class="form-control" id="namaInput" name='username' placeholder="Ex: @photomaticsid" required>
            </div>

            <div class="mb-3">
                <label for="exampleSelect" class="form-label"><b>Cabang Photomatics</b></label>
                <select class="form-select" id="cabangSelect" name="cabang" required>
                  <option value="" disabled selected hidden>Pilih Cabang</option>
                  <option value="1">Photomatics Wonderland (Jakarta)</option>
                  <option value="2">Trans Studio Mall Cibubur (Jakarta)</option>
                  <option value="3">SMYD (Pallete) - Blok M (Jakarta)</option>
                  <option value="4">Warnoes Margonda (Depok)</option>
                  <option value="5">Kopitagram - Cinere (Depok)</option>
                  <option value="6">Pasar Tunjungan (Surabaya)</option>
                  <option value="7">Ada Apa Dengan Kopi (AADK) - Wiyung (Surabaya)</option>
                  <option value="8">Female Daily Studio (Surabaya)</option>
                </select>
              </div>
              
              <div class="mb-3">
                <label class="form-label"><b>Rating</b></label>
                <div id="ratingStars" class="mb-2">
                  <i class="bi bi-star-fill text-warning fs-4 star" data-value="1"></i>
                  <i class="bi bi-star-fill text-warning fs-4 star" data-value="2"></i>
                  <i class="bi bi-star-fill text-warning fs-4 star" data-value="3"></i>
                  <i class="bi bi-star-fill text-warning fs-4 star" data-value="4"></i>
                  <i class="bi bi-star-fill text-warning fs-4 star" data-value="5"></i>
                </div>
                <div class="d-flex align-items-center">
                  <div id="ratingScore" class="me-2">3 / 5</div>
                  <div id="ratingLabel" class="badge" style="background-color: #ffc107; color: #ffffff;">Lumayan Oke :|</div>
                </div>
              </div>
              
              <div class="mb-3">
                <label for="reviewInput" class="form-label"><b>Review</b></label>
                <textarea class="form-control" id="reviewInput" rows="3" name="review" placeholder="Berikan Review, Kritik, dan Saran Kamu Disini!" required></textarea>
              </div>

            <button type="submit" class="btn" style="background-color: #992e14; color: white;">Submit</button>
        </form>
    </div>
    
    <!-- Hasil Isi Form -->
    <h1 class="text-center mt-4"><i>Photomatics Review</i></h1><hr>
    <div class="table-container table-responsive">
        <table id="reviewTable" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Cabang</th>
                    <th>Rating</th>
                    <th class="review-col">Review</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    

    <!-- Footer -->
    <nav class="navbar fixed-bottom" style="background-color: #f6c36d;">
        <div class="container-fluid justify-content-center">
          <span class="navbar-text text-center">
            @2025 Copyright:NabilahLiandaP
          </span>
        </div>
      </nav>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js" integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script>
        const stars = document.querySelectorAll('.star');
        const ratingScore = document.getElementById('ratingScore');
        const ratingLabel = document.getElementById('ratingLabel');
      
        let currentRating = 3; // default 3
      
        stars.forEach((star, index) => {
          star.addEventListener('click', () => {
            currentRating = index + 1;
            updateRating(currentRating);
          });
      
          star.addEventListener('mouseover', () => {
            highlightStars(index + 1);
          });
      
          star.addEventListener('mouseout', () => {
            highlightStars(currentRating);
          });
        });
      
        function updateRating(rating) {
          ratingScore.innerText = `${rating} / 5`;
      
          let label = '-';
          let color = '#6c757d'; 
          let textColor = '#ffffff';
      
          if (rating === 1) {
            label = 'Kecewa :(';
            color = '#dc3545'; 
          } else if (rating === 2) {
            label = 'Biasa Aja :/';
            color = '#fd7e14'; 
          } else if (rating === 3) {
            label = 'Lumayan Oke :|';
            color = '#ffc107'; 
          } else if (rating === 4) {
            label = 'Bagus :)';
            color = '#b8e994'; 
          } else if (rating === 5) {
            label = 'Perfect! :D';
            color = '#146c43'; 
          }
      
          ratingLabel.innerText = label;
          ratingLabel.style.backgroundColor = color;
          ratingLabel.style.color = textColor;
      
          highlightStars(rating);
        }
      
        function highlightStars(rating) {
          stars.forEach((star, index) => {
            if (index < rating) {
              star.classList.add('text-warning');
              star.classList.remove('text-secondary');
            } else {
              star.classList.remove('text-warning');
              star.classList.add('text-secondary');
            }
          });
        }
      
        updateRating(currentRating); 
      </script>

      <!-- Script Send Google Sheets -->
      <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbzQe7zYsQMf0dOR4nYOjlguwoPnfAWuc_Com35v1X3XVKg9POfjAD5O-NyVliy-rQQWAg/exec';
        const form = document.getElementById('reviewForm');

        form.addEventListener('submit', e => {
        e.preventDefault();

        const formData = new FormData(form);
        formData.append("rating", currentRating); 

        fetch(scriptURL, {
          method: 'POST',
          body: formData
        })
        .then(response => {
          alert("Review berhasil dikirim!");
          form.reset();
          updateRating(3); 
        })
        .catch(error => {
          alert("Terjadi kesalahan saat mengirim review.");
          console.error('Error!', error.message);
        });
      });
      </script>

    <!-- Script Tabel -->
      <script>
        $(document).ready(function () {
        const table = $('#reviewTable').DataTable();

        $('form').on('submit', function (e) {
          e.preventDefault(); 
          const nama = $('#namaInput').val();
          const cabang = $('#cabangSelect option:selected').text();
          const rating = currentRating; 
          const review = $('#reviewInput').val();
          
          $('#namaInput').val('');
          $('#cabangSelect').val('');
          $('#reviewInput').val('');
          
          table.row.add([
            nama,
            cabang,
            `${rating} / 5`,
            review
          ]).draw();

          updateRating(3); 
        });
      });
      </script>     
      
      <!-- Script Hasil Review -->
      <script>
        const cabangMapping = {
            1: "Photomatics Wonderland (Jakarta)",
            2: "Trans Studio Mall Cibubur (Jakarta)",
            3: "SMYD (Pallete) - Blok M (Jakarta)",
            4: "Warnoes Margonda (Depok)",
            5: "Kopitagram - Cinere (Depok)",
            6: "Pasar Tunjungan (Surabaya)",
            7: "Ada Apa Dengan Kopi (AADK) - Wiyung (Surabaya)",
            8: "Female Daily Studio (Surabaya)"
        };
    
        $(document).ready(function() {
            const table = $('#reviewTable').DataTable();
            fetch('https://script.google.com/macros/s/AKfycbyIE1khOPPfsrwAKLAKZSX5pbrnPq6Hcm4FE-oDWitbPJ9s2j2X2DE6ht30XL5h3eRT2Q/exec')
                .then(response => response.json())
                .then(data => {
                    table.clear();
    
                    data.forEach(item => {
                        const cabangNama = cabangMapping[item.cabang] || 'Cabang Tidak Dikenal'; 
                        table.row.add([
                            item.username,
                            cabangNama,
                            item.rating,
                            item.review
                        ]).draw();
                    });
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        });
    </script>
</body>
</html>
